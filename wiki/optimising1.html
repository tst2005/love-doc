<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en" dir="ltr">
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
		<meta name="generator" content="MediaWiki 1.16.2" />
<link rel="shortcut icon" href="favicon1.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="opensearch_desc1.php" title="LOVE (en)" />
<link title="Creative Commons" type="application/rdf+xml" href="" rel="meta" />
<link rel="copyright" href="http://www.gnu.org/copyleft/fdl.html" />
<link rel="alternate" type="application/atom+xml" title="LOVE Atom feed" href="" />		<title>Optimising - LOVE</title>
		<link rel="stylesheet" href="shared1.css" media="screen" />
<link rel="stylesheet" href="commonprint1.css" media="print" />
<link rel="stylesheet" href="main1.css" media="screen" />
<link rel="stylesheet" href="" />
<link rel="stylesheet" href="" media="print" />
<link rel="stylesheet" href="" />
<link rel="stylesheet" href="" />
		<!--[if lt IE 7]><script type="text/javascript" src="iefixes1.js_270"></script>
		<meta http-equiv="imagetoolbar" content="no" /><![endif]-->

		<script>
var skin="love",
stylepath="/w/skins",
wgUrlProtocols="http\\:\\/\\/|https\\:\\/\\/|ftp\\:\\/\\/|irc\\:\\/\\/|gopher\\:\\/\\/|telnet\\:\\/\\/|nntp\\:\\/\\/|worldwind\\:\\/\\/|mailto\\:|news\\:|svn\\:\\/\\/",
wgArticlePath="/wiki/$1",
wgScriptPath="/w",
wgScriptExtension=".php",
wgScript="/w/index.php",
wgVariantArticlePath=false,
wgActionPaths={},
wgServer="https://www.love2d.org",
wgCanonicalNamespace="",
wgCanonicalSpecialPageName=false,
wgNamespaceNumber=0,
wgPageName="Optimising",
wgTitle="Optimising",
wgAction="view",
wgArticleId=634,
wgIsArticle=true,
wgUserName=null,
wgUserGroups=null,
wgUserLanguage="en",
wgContentLanguage="en",
wgBreakFrames=false,
wgCurRevisionId=13722,
wgVersion="1.16.2",
wgEnableAPI=true,
wgEnableWriteAPI=true,
wgSeparatorTransformTable=["", ""],
wgDigitTransformTable=["", ""],
wgMainPageTitle="Main Page",
wgFormattedNamespaces={"-2": "Media", "-1": "Special", "0": "", "1": "Talk", "2": "User", "3": "User talk", "4": "LOVE", "5": "LOVE talk", "6": "File", "7": "File talk", "8": "MediaWiki", "9": "MediaWiki talk", "10": "Template", "11": "Template talk", "12": "Help", "13": "Help talk", "14": "Category", "15": "Category talk", "102": "Property", "103": "Property talk", "104": "Type", "105": "Type talk", "108": "Concept", "109": "Concept talk", "500": "Tutorial", "501": "Tutorial talk"},
wgNamespaceIds={"media": -2, "special": -1, "": 0, "talk": 1, "user": 2, "user_talk": 3, "love": 4, "love_talk": 5, "file": 6, "file_talk": 7, "mediawiki": 8, "mediawiki_talk": 9, "template": 10, "template_talk": 11, "help": 12, "help_talk": 13, "category": 14, "category_talk": 15, "property": 102, "property_talk": 103, "type": 104, "type_talk": 105, "concept": 108, "concept_talk": 109, "tutorial": 500, "tutorial_talk": 501, "image": 6, "image_talk": 7},
wgSiteName="LOVE",
wgCategories=["LÖVE", "Tips"],
wgRestrictionEdit=[],
wgRestrictionMove=[];
</script>
		<script type="text/javascript" src="wikibits1.js_270"><!-- wikibits js --></script>
		<!-- Head Scripts -->
<script src="ajax1.js_270"></script>
		<link rel="alternate" type="application/rdf+xml" title="Optimising" href="" />
		<script type="text/javascript" src=""><!-- site js --></script>
  <!-- Google Analytics -->
  <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-6143729-1']);
    _gaq.push(['_trackPageview']);
    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
  </script>
  <script src="egg1.js"></script>
  <link href="https://plus.google.com/b/108553500970002863436/" rel="publisher" />
	</head>
<body class="mediawiki ltr ns-0 ns-subject page-Optimising skin-love">
	<div id="globalWrapper">
		<div id="column-content">
	<div id="content">
		<a name="top" id="top"></a>
			
		<div id="p-cactions">
			<h5>Views</h5>
			<div>
				<ul>
		
					 <li id="ca-nstab-main" class="selected"><a href="" title="View the content page [c]" accesskey="c">Page</a></li>
					 <li id="ca-talk" class="new"><a href="" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
					 <li id="ca-viewsource"><a href="" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
					 <li id="ca-history"><a href="" title="Past revisions of this page [h]" accesskey="h">History</a></li>				</ul>
			</div>
		</div>
	
		<h1 id="firstHeading" class="firstHeading">Optimising</h1>
		<div id="bodyContent">
			<div id="contentSub"></div>
									<!-- start content -->
			<p>Optimising in <a href="" class="new" title="Lua (page does not exist)">Lua</a> is often counter-intuitive. Never assume a change has improved performance, even if you "know", logically, that it would have. Always check. Always.
</p>
<h1> <span class="mw-headline" id="General_Optimising_Tips">General Optimising Tips</span></h1>
<h2> <span class="mw-headline" id="Root_of_all_evil"> Root of all evil </span></h2>
<dl><dt><b>Donald Knuth</b> said,
</dt><dd> <i>" premature optimization is the root of all evil"</i>
</dd></dl>
<p>In other words, don't do heavy optimisation until you see things slowing down.
</p><p>That is all.
</p>
<h2> <span class="mw-headline" id="Be_a_sniper.2C_not_a_carpet_bomber"> Be a sniper, not a carpet bomber </span></h2>
<p>Hit the target, not the square mile its in.
</p><p>Much like the CPU cycles you are trying to save, your time is valuable. Don't waste it optimising code that isn't slowing you down. <a href="" class="new" title="Profile (page does not exist)">Profile</a> your code, figure out where your bottlenecks are, and optimise <i>those</i>.
</p>
<h1> <span class="mw-headline" id="General_Lua_Optimisation">General Lua Optimisation</span></h1>
<h2> <span class="mw-headline" id="Keep_loops_short_and_sweet"> Keep loops short and sweet </span></h2>
<p>While loops are useful and important construct in any program, they are also <i>repetitious</i>, and like to magnify the effects of any statements within them. Every performance tip in here applies double to loops.
</p><p>When designing loops, consider if each individual statement <i>really</i> needs to be in the body of the loop, everything that can be legitimately moved outside the body of the loop will reduce the time it takes for the loop to complete.
</p>
<h2> <span class="mw-headline" id="Prefer_numerical_fors.2C_and_ipairs"> Prefer numerical <i>for</i>s, and <i>ipairs</i> </span></h2>
<p>Lua's <i>table</i>s are powerful useful and, to Lua's credit, fairly fast. The <i>pairs</i> iterator allows you to easily loop through all of the elements in a <i>table</i>, rather than <i>ipairs</i> merely looping through the elements with <a href="" class="new" title="integral (page does not exist)">integral</a> numeric keys in <a href="" class="new" title="Lua Tables-as-arrays (page does not exist)">1 to n</a>. It is, however, not the fastest way to loop through a table, <i>ipairs</i> is faster, but the fastest is the humble numerical for; "for i=1,n do ... end". Yes, its not as elegant, but its still the fastest.
</p>
<h2> <span class="mw-headline" id="Use_Locals">Use <i>Local</i>s</span></h2>
<p>In Lua, Variables are generally either <i><a href="" class="new" title="global (page does not exist)">global</a></i>s (the default), or <i><a href="local1.html" title="local">local</a></i>s. Lua  keeps a short list of <i>local</i> variables that it checks before checking the global environment. Generally this means that <i>local</i> look-ups are "just plain faster" than <i>global</i>s.
Normally this performance gain is splitting hairs, but there's a common situation where it can be noticeable.
</p><p>Consider the following:
</p>
<div dir="ltr" class="mw-geshi" style="text-align: left;"><div class="lua source-lua">&nbsp;<span class="co1">--WRONG WAY</span><br />&nbsp; &nbsp;<span class="kw1">for</span> i<span class="sy0">=</span><span class="nu0">1</span>,<span class="nu0">1000000</span> <span class="kw1">do</span><br />&nbsp; &nbsp; &nbsp;localx <span class="sy0">=</span> <span class="kw1">math.sin</span><span class="br0">&#40;</span>i<span class="br0">&#41;</span><br />&nbsp; &nbsp;<span class="kw1">end</span><br /><br />&nbsp;<span class="co1">--RIGHT WAY</span><br />&nbsp; &nbsp;<span class="kw1">local</span> <span class="kw1">sin</span> <span class="sy0">=</span> <span class="kw1">math.sin</span><br />&nbsp; &nbsp;<span class="kw1">for</span> i<span class="sy0">=</span><span class="nu0">1</span>, <span class="nu0">1000000</span> <span class="kw1">do</span><br />&nbsp; &nbsp; &nbsp;localx <span class="sy0">=</span> <span class="kw1">sin</span><span class="br0">&#40;</span>i<span class="br0">&#41;</span><br />&nbsp; &nbsp;<span class="kw1">end</span></div></div>
<ul><li> In the <b>WRONG WAY</b> example, each use of <i>math.sin()</i> would require two look-ups, once in <i>_G</i>, looking for <i>math</i>, and again in <i>math</i> looking for <i>sin</i>; and this would happen every iteration of the loop (so about 2,000,000 look-ups).
</li></ul>
<ul><li> In the <b>RIGHT WAY</b> example, we begin by creating a local containing the <i>math.sin()</i> function. its this value which is then used in the loop. Immediately its obvious that we've basically halved the number of look-ups required by this section code, and that's without considering that local look-ups are cheaper than global look ups.
</li></ul>
<h1> <span class="mw-headline" id="Love-Specific_Tips">Love-Specific Tips</span></h1>
<h2> <span class="mw-headline" id="Cull_the_herd">Cull the herd</span></h2>
<p>It can be tempting to design drawing functions that make little or no attempt to consider the visibility of game elements, relying instead on the graphics hardware's basic <a href="" class="new" title="clipping (page does not exist)">clipping</a> capabilities. if nothing else, this can often give simpler and easier to understand functions.
</p><p>But even if these elements aren't visible, they still need to be transformed and processed, and their data sent to the card's hardware. Depending on your game's design, you might do additional calculations for that element, such as calculating <a href="" class="new" title="look-at (page does not exist)">look-ats</a>, or blending colors. All of which are unnecessary, give that the element isn't actually visible, and on <a href="" class="new" title="non-trivial (page does not exist)">non-trivial</a> projects, this can be a performance cost you can ill-afford.
</p><p><a href="" class="new" title="Refactor (page does not exist)">Refactor</a> your code to avoid calculations that only need to be done visible elements, and avoid sending any data to the hardware about objects you can determine won't be visible.
</p>
<h2> <span class="mw-headline" id="Avoid_Overdraw">Avoid Overdraw</span></h2>
<p>Overdraw is when you draw over part of the screen that you had already drawn to in the current frame. much like in the <i>Cull the Herd</i> tip above, this is wasted effort. Why spend time drawing something that won't be seen?
</p><p>The old axiom from the early days of graphical gaming was "touch every pixel only once", (I.E. zero-overdraw). fortunately hardware has come a long way since then, and some slovenliness is perfectly reasonable if it offers some other advantage (such as simpler code), but should avoid engine designs that are likely to create large amounts of overdraw.
</p>
<h2> <span class="mw-headline" id="Watch_the_hidden_loops"> Watch the hidden loops </span></h2>
<p>Love calls the functions <i><a href="love316.html" title="love.update">love.update</a>(dt)</i> and <i><a href="love317.html" title="love.draw">love.draw</a>()</i> frequently during the lifetime of a Love game. in fact, they are the body of loops hidden in <i><a href="love313.html" title="love.run">love.run</a>()</i>. All the performance considerations that apply to loops, apply to these two callbacks as well.
</p>
<h1> <span class="mw-headline" id="Further_Tips">Further Tips</span></h1>
<ul><li> <a href="http://trac.caspring.org/wiki/LuaPerformance" class="external text" rel="nofollow">LuaPerformance</a> at trac
</li></ul>

<!-- 
NewPP limit report
Preprocessor node count: 56/1000000
Post-expand include size: 0/2097152 bytes
Template argument size: 0/2097152 bytes
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key love2d_wiki:pcache:idhash:634-0!1!0!!en!2!edit=0 and timestamp 20150126000508 -->
<div class="printfooter">
Retrieved from "<a href="https://www.love2d.org/wiki/Optimising">https://www.love2d.org/wiki/Optimising</a>"</div>
			<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks"><a href="" title="Special:Categories">Categories</a>: <span dir='ltr'><a href="category_l_ve1.html" title="Category:LÖVE">LÖVE</a></span> | <span dir='ltr'><a href="" class="new" title="Category:Tips (page does not exist)">Tips</a></span></div></div>			<!-- end content -->
						<div class="visualClear"></div>
		</div>
	</div>
		</div>
		<div id="column-one">

	<div class="portlet" id="p-personal">
		<h5>Personal tools</h5>
		<div class="pBody">
			<ul>
				<li id="pt-login"><a href="" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>
			</ul>
		</div>
	</div>
	<div class="portlet" id="p-logo">
		<a style="background-image: url(wiki1.png);" href="index9.html" title="Visit the main page"></a>
	</div>
<!--	<div class="portlet" id="p-docs">
		<h5>Documentation</h5>
		<div class="pBody">
			<ul>
				<li><a href="love272.html">love</a></li>
				<li><a href="love273.html">love.audio</a></li>
				<li><a href="love274.html">love.event</a></li>
				<li><a href="love275.html">love.filesystem</a></li>
				<li><a href="love276.html">love.graphics</a></li>
				<li><a href="love277.html">love.image</a></li>
				<li><a href="love278.html">love.joystick</a></li>
				<li><a href="love279.html">love.keyboard</a></li>
				<li><a href="love280.html">love.math</a></li>
				<li><a href="love281.html">love.mouse</a></li>
				<li><a href="love282.html">love.physics</a></li>
				<li><a href="love283.html">love.sound</a></li>
				<li><a href="love284.html">love.system</a></li>
				<li><a href="love285.html">love.timer</a></li>
				<li><a href="love286.html">love.window</a></li>
			</ul>
		</div>
	</div> -->
	<script type="text/javascript"> if (window.isMSIE55) fixalpha(); </script>
	<div class='generated-sidebar portlet' id='p-documentation'>
		<h5>documentation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-love"><a href="love272.html">love</a></li>
				<li id="n-love.audio"><a href="love273.html">love.audio</a></li>
				<li id="n-love.event"><a href="love274.html">love.event</a></li>
				<li id="n-love.filesystem"><a href="love275.html">love.filesystem</a></li>
				<li id="n-love.font"><a href="love287.html">love.font</a></li>
				<li id="n-love.graphics"><a href="love276.html">love.graphics</a></li>
				<li id="n-love.image"><a href="love277.html">love.image</a></li>
				<li id="n-love.joystick"><a href="love278.html">love.joystick</a></li>
				<li id="n-love.keyboard"><a href="love279.html">love.keyboard</a></li>
				<li id="n-love.math"><a href="love280.html">love.math</a></li>
				<li id="n-love.mouse"><a href="love281.html">love.mouse</a></li>
				<li id="n-love.physics"><a href="love282.html">love.physics</a></li>
				<li id="n-love.sound"><a href="love283.html">love.sound</a></li>
				<li id="n-love.system"><a href="love284.html">love.system</a></li>
				<li id="n-love.thread"><a href="love288.html">love.thread</a></li>
				<li id="n-love.timer"><a href="love285.html">love.timer</a></li>
				<li id="n-love.window"><a href="love286.html">love.window</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-navigation'>
		<h5>Navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-Home"><a href="love2d1.html">Home</a></li>
				<li id="n-Forums"><a href="forums.html">Forums</a></li>
				<li id="n-Issue-tracker"><a href="http://bitbucket.org/rude/love/issues">Issue tracker</a></li>
			</ul>
		</div>
	</div>
	<div class='generated-sidebar portlet' id='p-wiki_navigation'>
		<h5>wiki navigation</h5>
		<div class='pBody'>
			<ul>
				<li id="n-mainpage-description"><a href="index9.html" title="Visit the main page [z]" accesskey="z">Main page</a></li>
				<li id="n-recentchanges"><a href="" title="The list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li>
				<li id="n-randompage"><a href="" title="Load a random page [x]" accesskey="x">Random page</a></li>
			</ul>
		</div>
	</div>
	<div id="p-search" class="portlet">
		<h5><label for="searchInput">Search</label></h5>
		<div id="searchBody" class="pBody">
			<form action="w1.html" id="searchform"><div>
				<input type='hidden' name="title" value="Special:Search"/>
				<input id="searchInput" name="search" type="text" title="Search LOVE [f]" accesskey="f" value="" />
				<input type='submit' name="go" class="searchButton" id="searchGoButton"	value="Go" title="Go to a page with this exact name if exists" />&nbsp;
				<input type='submit' name="fulltext" class="searchButton" id="mw-searchButton" value="Search" title="Search the pages for this text" />
			</div></form>
		</div>
	</div>
	<div class="portlet" id="p-tb">
		<h5>Toolbox</h5>
		<div class="pBody">
			<ul>
				<li id="t-whatlinkshere"><a href="" title="List of all wiki pages that link here [j]" accesskey="j">What links here</a></li>
				<li id="t-recentchangeslinked"><a href="" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li>
<li id="t-specialpages"><a href="" title="List of all special pages [q]" accesskey="q">Special pages</a></li>
				<li id="t-print"><a href="" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li>				<li id="t-permalink"><a href="" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-smwbrowselink"><a href="" title="Special:Browse/Optimising">Browse properties</a></li>			</ul>
		</div>
	</div>
		</div><!-- end of the left (by default at least) column -->
			<div class="visualClear"></div>
			<div id="footer">
				<div id="f-poweredbyico"><a href="http://www.mediawiki.org/"><img src="poweredby_mediawiki_88x311.png" height="31" width="88" alt="Powered by MediaWiki" /></a></div>
				<div id="f-copyrightico"><a href="http://www.gnu.org/copyleft/fdl.html"><img src="gnu_fdl1.png" alt="GNU Free Documentation License 1.3" width="88" height="31" /></a></div>
			<ul id="f-list">
					<li id="lastmod"> This page was last modified on 17 August 2014, at 23:34.</li>
					<li id="viewcount">This page has been accessed 5,441 times.</li>
					<li id="copyright">Content is available under <a href="http://www.gnu.org/copyleft/fdl.html" class="external ">GNU Free Documentation License 1.3</a>.</li>
					<li id="privacy"><a href="love_privacy_policy1.html" title="LOVE:Privacy policy">Privacy policy</a></li>
					<li id="about"><a href="love_about1.html" title="LOVE:About">About LOVE</a></li>
					<li id="disclaimer"><a href="love_general_disclaimer1.html" title="LOVE:General disclaimer">Disclaimers</a></li>
			</ul>
		</div>
</div>

<script>if (window.runOnloadHook) runOnloadHook();</script>
<!-- Served in 0.267 secs. --></body></html>
